<!DOCTYPE html>
<html lang="zh">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="MkDocs Team">
        <link rel="canonical" href="https://www.mkdocs.org/dev-guide/themes/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>主题 - MkDocs</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet">
        <link href="../../css/extra.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/django.min.js"></script>
        <script>hljs.highlightAll();</script>
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-274394082"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', "G-274394082");
        </script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">MkDocs</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../../getting-started/" class="nav-link">Getting Started</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../user-guide/" class="dropdown-item">用户指南</a>
</li>
                                    
<li>
    <a href="../../user-guide/installation/" class="dropdown-item">安装</a>
</li>
                                    
<li>
    <a href="../../user-guide/writing-your-docs/" class="dropdown-item">编写文档</a>
</li>
                                    
<li>
    <a href="../../user-guide/choosing-your-theme/" class="dropdown-item">选择主题</a>
</li>
                                    
<li>
    <a href="../../user-guide/customizing-your-theme/" class="dropdown-item">自定义主题</a>
</li>
                                    
<li>
    <a href="../../user-guide/localizing-your-theme/" class="dropdown-item">本地化主题</a>
</li>
                                    
<li>
    <a href="../../user-guide/configuration/" class="dropdown-item">配置</a>
</li>
                                    
<li>
    <a href="../../user-guide/cli/" class="dropdown-item">命令行界面</a>
</li>
                                    
<li>
    <a href="../../user-guide/deploying-your-docs/" class="dropdown-item">部署文档</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Developer Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../" class="dropdown-item">开发者指南</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">主题</a>
</li>
                                    
<li>
    <a href="../translations/" class="dropdown-item">翻译</a>
</li>
                                    
<li>
    <a href="../plugins/" class="dropdown-item">插件</a>
</li>
                                    
<li>
    <a href="../api/" class="dropdown-item">API 参考</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../about/release-notes/" class="dropdown-item">Release Notes</a>
</li>
                                    
<li>
    <a href="../../about/contributing/" class="dropdown-item">Contributing</a>
</li>
                                    
<li>
    <a href="../../about/license/" class="dropdown-item">License</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../translations/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/mkdocs/mkdocs/blob/master/docs/dev-guide/themes.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#_1" class="nav-link">主题开发</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#_2" class="nav-link">创建自定义主题</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_3" class="nav-link">基础主题</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_4" class="nav-link">主题文件</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_9" class="nav-link">模板变量</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_11" class="nav-link">搜索和主题</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_12" class="nav-link">支持主题本地化/翻译</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="_1">主题开发<a class="headerlink" href="#_1" title="Permanent link"></a></h1>
<p>创建和分发自定义主题的指南。</p>
<p>注意：
如果您正在寻找现有的第三方主题，它们列在<a href="https://github.com/mkdocs/mkdocs/wiki/MkDocs-Themes">社区Wiki页面</a>和 <a href="https://github.com/mkdocs/catalog#-theming">MkDocs项目目录</a>中。如果您想分享自己创作的主题，请在那里列出。
当创建一个新主题时，您可以按照这个指南的步骤从头开始创建，或者您可以下载 <code>mkdocs-basic-theme</code> 作为一个基本但完整的主题，并包含所有必要的样板文件。<strong>您可以在 <a href="https://github.com/mkdocs/mkdocs-basic-theme">GitHub</a> 找到该基础主题</strong>。它在代码中包含了详细的注释，以描述不同的特性及其用法。</p>
<h2 id="_2">创建自定义主题<a class="headerlink" href="#_2" title="Permanent link"></a></h2>
<p>自定义主题所需的最少条件是在一个目录中放置一个 <code>main.html</code> <a href="https://jinja.palletsprojects.com/">Jinja2 模板文件</a>，该目录不是 <a href="../../user-guide/configuration/#docs_dir">docs_dir</a> 的子目录。
在 <code>mkdocs.yml</code> 中，将 <a href="../../user-guide/configuration/#custom_dir"><code>theme.custom_dir</code></a> 选项设置为包含 <code>main.html</code> 的目录的路径。该路径应与配置文件的相对路径一致。
例如，给定此示例项目布局：</p>
<pre class="highlight"><code class="language-text">mkdocs.yml
docs/
    index.md
    about.md
custom_theme/
    main.html
    ...</code></pre>
<p>...可在 <code>mkdocs.yml</code> 中包含以下设置以使用自定义主题目录：
<pre class="highlight"><code class="language-yaml">theme:
  name: null
  custom_dir: 'custom_theme/'</code></pre></p>
<blockquote>
<p>注意：
通常在构建自己的自定义主题时，<code>theme.[name]</code> 配置设置应被设置为 'null'。然而，如果将 <code>theme.[custom_dir]</code> 配置值与现有主题结合使用，则可用于仅替换内置主题中的特定部分。
例如，对于上面的布局，如果将 <code>name: "mkdocs"</code>，则在主题目录中的 <code>main.html</code> 文件将替换 <code>mkdocs</code> 主题中的同名文件，但否则 <code>mkdocs</code> 主题将保持不变。如果您想对现有主题进行小的调整，这很有用。
有关更具体的信息，请参阅<a href="../../user-guide/customizing-your-theme/#using-the-theme-custom_dir">自定义主题</a>。</p>
</blockquote>
<!-- -->
<blockquote>
<p>警告：
主题在 <code>theme.custom_dir</code> 中存在时定义在 <code>mkdocs_theme.yml</code> 文件中的主题[配置]不会被加载。
当整个主题存在于 <code>theme.custom_dir</code> 中并且 <code>theme.name</code> 被设置为 'null' 时，则必须在 <code>mkdocs.yml</code> 文件的 <a href="../../user-guide/configuration/#theme">theme</a> 配置选项中定义整个主题配置。
然而，在打包主题进行分发时，使用 <code>theme.name</code> 配置选项进行加载时，则需要一个 <code>mkdocs_theme.yml</code> 文件。</p>
</blockquote>
<h2 id="_3">基础主题<a class="headerlink" href="#_3" title="Permanent link"></a></h2>
<p>最简单的 <code>main.html</code> 文件如下：</p>
<pre class="highlight"><code class="language-django">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;{% if page.title %}{{ page.title }} - {% endif %}{{ config.site_name }}&lt;/title&gt;
    {%- for path in config.extra_css %}
      &lt;link href="{{ path | url }}" rel="stylesheet"&gt;
    {%- endfor %}
  &lt;/head&gt;
  &lt;body&gt;
    {{ page.content }}

    {%- for script in config.extra_javascript %}
      {{ script | script_tag }}
    {%- endfor %}
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
<p>从 <code>mkdocs.yml</code> 中指定内容插入到此主题和正常 HTML 文件一样，可以引入样式表和脚本。NavBar 和目录也可以自动生成并包含进来，分别使用 <code>nav</code> 和 <code>toc</code> 对象。
如果您想编写自己的主题，建议从一个 <a href="../../user-guide/customizing-your-theme/#built-in-themes">内置主题</a> 开始，并相应地进行修改。</p>
<p>注意：
MkDocs 使用 <a href="https://jinja.palletsprojects.com/">Jinja</a> 作为其模板引擎，您可以访问 Jinja 的所有强大功能，包括 <a href="https://jinja.palletsprojects.com/en/latest/templates/#template-inheritance">模板继承</a>。
您可能会注意到，随 MkDocs 一起提供的主题广泛使用模板继承和块，允许用户轻松覆盖主题 <a href="../../user-guide/configuration/#custom_dir">custom_dir</a> 中的模板的小块和片段。因此，内置主题是用 <code>base.html</code> 文件实现的，而 <code>main.html</code> 扩展了 <code>base.html</code>。
尽管这不是必需的，但鼓励第三方模板作者遵循类似的模式，并可能希望定义内置主题中使用的相同块 <a href="../../user-guide/customizing-your-theme/#overriding-template-blocks">blocks</a>，以保持一致性。</p>
<h3 id="css-javascript">从配置中获取 CSS 和 JavaScript<a class="headerlink" href="#css-javascript" title="Permanent link"></a></h3>
<p>MkDocs 定义了顶级配置 <a href="../../user-guide/configuration/#extra_css">extra_css</a> 和 <a href="../../user-guide/configuration/#extra_javascript">extra_javascript</a>。它们都是文件列表。主题必须包含 HTML，以链接这些配置中的项目，否则配置将无法正常工作。您可以在<a href="#基础主题">基础主题示例</a>中看到一个推荐的方式来呈现这两者的内容。</p>
<blockquote>
<p>新增：<strong>自 MkDocs 1.5 版本更改：</strong></p>
<p><code>config.extra_javascript</code> 列表的项过去是简单字符串，现在变成了具有以下字段的对象：<code>path</code>、<code>type</code>、<code>async</code>、<code>defer</code>。
在这个版本中，MkDocs 还增加了 <a href="#script_tag"><code>script_tag</code> 过滤器</a>。</p>
<p>示例的旧样式是：
<pre class="highlight"><code class="language-django">  {%- for path in extra_javascript %}
    &lt;script src="{{ path }}"&gt;&lt;/script&gt;
  {%- endfor %}</code></pre>
这个旧样式甚至使用了不推荐的顶级 <code>extra_javascript</code> 列表。请始终使用 <code>config.extra_javascript</code>。
因此，一种略微更新的方法是：
<pre class="highlight"><code class="language-django">  {%- for path in config.extra_javascript %}
    &lt;script src="{{ path | url }}"&gt;&lt;/script&gt;
  {%- endfor %}</code></pre></p>
<blockquote>
<p>? 示例中说的新增用法为：
<pre class="highlight"><code class="language-django">  {%- for script in config.extra_javascript %}
    {{ script | script_tag }}
  {%- endfor %}</code></pre></p>
</blockquote>
<p>如果您希望在保持主题与旧版 MkDocs 兼容的同时，能够使用新的自定义内容，请使用以下代码片段：</p>
<blockquote>
<p>示例：<strong>向后兼容的样式</strong></p>
<pre class="highlight"><code class="language-django">  {%- for script in config.extra_javascript %}
    {%- if script.path %}  {# 检测到 MkDocs 1.5+，其拥有 `script.path` 和 `script_tag` #}
      {{ script | script_tag }}
    {%- else %}  {# 向后兼容 - 直接检查文件名 #}
      &lt;script src="{{ script | url }}"{% if script.endswith(".mjs") %} type="module"{% endif %}&gt;&lt;/script&gt;
    {%- endif %}
  {%- endfor %}</code></pre>
</blockquote>
</blockquote>
<h2 id="_4">主题文件<a class="headerlink" href="#_4" title="Permanent link"></a></h2>
<p>主题以某种方式特殊对待各种文件。所有其他文件都只是从主题目录复制到 <code>site_dir</code> 中的相同路径。例如，图像和 CSS 文件没有特殊意义，将原样复制。但是，请注意，如果用户提供具有相同路径的文件，则用户的文件将替换主题文件。</p>
<h3 id="_5">模板文件<a class="headerlink" href="#_5" title="Permanent link"></a></h3>
<p>任何具有 <code>.html</code> 扩展名的文件都被视为模板文件，不会从主题目录或任何子目录复制。同时，任何在 <a href="#static_templates">static_templates</a> 中列出的文件都视为模板，无论其文件扩展名如何。</p>
<h3 id="_6">主题元文件<a class="headerlink" href="#_6" title="Permanent link"></a></h3>
<p>还会忽略打包主题所需的各种文件，具体来说，是 <code>mkdocs_theme.yml</code> 配置文件和任何 Python 文件。</p>
<h3 id="_7">点文件<a class="headerlink" href="#_7" title="Permanent link"></a></h3>
<p>主题作者可以通过用一个点开始的文件或目录名，明确地强制 MkDocs 忽略文件。以下任何文件都将被忽略：</p>
<pre class="highlight"><code class="language-text">.ignored.txt
.ignored/file.txt
foo/.ignored.txt
foo/.ignored/file.txt</code></pre>
<h3 id="_8">文档文件<a class="headerlink" href="#_8" title="Permanent link"></a></h3>
<p>所有文档文件都将被忽略。特别是，将忽略使用任何由 MkDocs 支持的文件扩展名的 Markdown 文件。此外，忽略了可能存在于主题目录中的任何 README 文件。</p>
<h2 id="_9">模板变量<a class="headerlink" href="#_9" title="Permanent link"></a></h2>
<p>每个主题的模板都是使用模板上下文生成的。这些变量可用于主题。上下文根据正在构建的模板而异。目前模板使用全局上下文或页面特定上下文。全局上下文用于不表示单个 Markdown 文档的 HTML 页面，例如 404.html 页面或 search.html。</p>
<h3 id="_10">全局上下文<a class="headerlink" href="#_10" title="Permanent link"></a></h3>
<p>下列变量对于任何模板都是全局可用的。</p>
<h4 id="config">config<a class="headerlink" href="#config" title="Permanent link"></a></h4>
<p><code>config</code> 变量是从 <code>mkdocs.yml</code> 配置文件生成的 MkDocs 配置对象的实例。您可以使用任何配置选项，但一些常用的选项包括：</p>
<ul>
<li><a href="../../user-guide/configuration/#site_name">config.site_name</a>：站点名称。</li>
<li><a href="../../user-guide/configuration/#site_url">config.site_url</a>：站点 URL。</li>
<li><a href="../../user-guide/configuration/#site_author">config.site_author</a>：站点作者。</li>
<li><a href="../../user-guide/configuration/#site_description">config.site_description</a>：站点说明。</li>
<li><a href="../../user-guide/configuration/#locale">config.theme.locale</a>（参见下文的 [主题配置]）。</li>
<li><a href="../../user-guide/configuration/#extra_javascript">config.extra_javascript</a>：额外的 JavaScript 文件。</li>
<li><a href="../../user-guide/configuration/#extra_css">config.extra_css</a>：额外的 CSS 文件。</li>
<li><a href="../../user-guide/configuration/#repo_url">config.repo_url</a>：源代码库的 URL。</li>
<li><a href="../../user-guide/configuration/#repo_name">config.repo_name</a>：源代码库名称。</li>
<li><a href="../../user-guide/configuration/#google_analytics">config.google_analytics</a>：Google Analytics ID。</li>
</ul>
<h4 id="nav">nav<a class="headerlink" href="#nav" title="Permanent link"></a></h4>
<p><code>nav</code> 变量用于为文档创建导航。<code>nav</code> 对象是 <a href="../../user-guide/configuration/#nav">nav</a> 配置 setting 定义的 <a href="#navigation-objects">导航对象</a> 的一个可迭代对象。</p>


<div class="doc doc-object doc-class">


<a id="mkdocs.structure.nav.Navigation"></a>
  <div class="doc doc-contents first">



  

  <div class="doc doc-children">











  </div>

  </div>

</div><p>除了迭代的 <a href="#navigation-objects">导航对象</a>，<code>nav</code> 对象还包含以下属性：</p>


<div class="doc doc-object doc-attribute">



<h5 id="mkdocs.structure.nav.Navigation.homepage" class="doc doc-heading">
<code class="highlight language-python">homepage: Page | None</code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#mkdocs.structure.nav.Navigation.homepage" class="headerlink" title="Permanent link"></a></h5>


  <div class="doc doc-contents first">
  
      <p>The [page][mkdocs.structure.pages.Page] object for the homepage of the site.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="mkdocs.structure.nav.Navigation.pages" class="doc doc-heading">
<code class="highlight language-python">pages: list[Page]</code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#mkdocs.structure.nav.Navigation.pages" class="headerlink" title="Permanent link"></a></h5>


  <div class="doc doc-contents first">
  
      <p>A flat list of all [page][mkdocs.structure.pages.Page] objects contained in the navigation.</p>
  </div>

</div><p>请注意，这个列表并不一定是所有站点页面的完整列表，因为它不包含未在导航中包含的页面。此列表与用于所有“下一页”和“上一页”链接的页面列表和顺序相匹配。要列出所有页面，请使用 <a href="#pages">pages</a> 模板变量。</p>
<h5 id="nav_1">Nav 示例<a class="headerlink" href="#nav_1" title="Permanent link"></a></h5>
<p>以下示例显示前两个层次的目录结构。</p>
<pre class="highlight"><code class="language-django">{% if nav|length &gt; 1 %}
    &lt;ul&gt;
    {% for nav_item in nav %}
        {% if nav_item.children %}
            &lt;li&gt;{{ nav_item.title }}
                &lt;ul&gt;
                {% for nav_item in nav_item.children %}
                    &lt;li class="{% if nav_item.active %}current{% endif %}"&gt;
                        &lt;a href="{{ nav_item.url|url }}"&gt;{{ nav_item.title }}&lt;/a&gt;
                    &lt;/li&gt;
                {% endfor %}
                &lt;/ul&gt;
            &lt;/li&gt;
        {% else %}
            &lt;li class="{% if nav_item.active %}current{% endif %}"&gt;
                &lt;a href="{{ nav_item.url|url }}"&gt;{{ nav绝对地址被原样传递。如果URL是相对的，而模板上下文包括一个页面对象，那么URL将相对于页面对象返回。否则，URL将附带[base_url]({#base_url})前缀返回。

```django
&lt;a href="{{ page.url|url }}"&gt;{{ page.title }}&lt;/a&gt;</code></pre>
<h3 id="tojson">tojson<a class="headerlink" href="#tojson" title="Permanent link"></a></h3>
<p>安全地将Python对象转换为JavaScript脚本中的值。</p>
<pre class="highlight"><code class="language-django">&lt;script&gt;
    var mkdocs_page_name = {{ page.title|tojson|safe }};
&lt;/script&gt;</code></pre>
<h3 id="script_tag">script_tag<a class="headerlink" href="#script_tag" title="Permanent link"></a></h3>
<p>新功能：自1.5版本起使用。</p>
<p>将<a href="../../user-guide/configuration/#extra_javascript">extra_javascript</a>中的项目转换为<code>&lt;script&gt;</code>标签，其中考虑了所有[此配置的自定义]，并内置了<a href="{#url}"><code>|url</code></a>行为的等效项。请参阅[基本主题]中如何使用它。</p>
<h2 id="_11">搜索和主题<a class="headerlink" href="#_11" title="Permanent link"></a></h2>
<p>自MkDocs版本0.17起，通过<code>search</code>插件向MkDocs添加了客户端搜索支持。主题需要提供一些东西供插件与主题一起使用。虽然<code>search</code>插件默认情况下已激活，用户可以禁用插件，主题应该考虑这一点。建议主题模板使用下面的插件检查将搜索特定标记包装进去：</p>
<pre class="highlight"><code class="language-django">{% if 'search' in config.plugins %}
    search stuff here...
{% endif %}</code></pre>
<p>在其最基本的功能中，搜索插件将简单地提供一个索引文件，该文件不超过包含所有页面内容的JSON文件。主题需要在客户端执行自己的搜索功能。然而，通过一些设置和必要的模板，该插件可以提供基于[lunr.js]的完整功能的客户端搜索工具。下面的HTML需要添加到该主题中，以使提供的JavaScript能够正确加载搜索脚本，并从当前页中的搜索结果创建相对链接。</p>
<pre class="highlight"><code class="language-django">&lt;script&gt;var base_url = {{ base_url|tojson }};&lt;/script&gt;</code></pre>
<p>使用正确配置的设置，模板中的以下HTML将向您的主题添加完整的搜索实现。</p>
<pre class="highlight"><code class="language-django">&lt;h1 id="search"&gt;Search Results&lt;/h1&gt;

&lt;form action="search.html"&gt;
  &lt;input name="q" id="mkdocs-search-query" type="text" &gt;
&lt;/form&gt;

&lt;div id="mkdocs-search-results"&gt;
  Sorry, page not found.&lt;/div&gt;</code></pre>
<p>插件中的JavaScript通过查找上述HTML中使用的特定ID来工作。用户为用户键入搜索查询的表单输入必须使用<code>id="mkdocs-search-query"</code>进行标识，并且将结果放置的div必须使用<code>id="mkdocs-search-results"</code>进行标识。插件支持在<a href="mkdocs_theme.yml">主题的配置文件</a>中设置以下选项:</p>
<h3 id="include_search_page">include_search_page<a class="headerlink" href="#include_search_page" title="Permanent link"></a></h3>
<p>确定搜索插件是否希望主题通过位于<code>search/search.html</code>的模板提供专用搜索页面。当<code>include_search_page</code>设置为<code>true</code>时，将构建并在<code>search/search.html</code>中提供搜索模板。该方法由<code>readthedocs</code>主题使用。当<code>include_search_page</code>设置为<code>false</code>或未定义时，期望该主题提供其他显示搜索结果的机制。例如，<code>mkdocs</code>主题通过模态方式在任何页面上显示结果。### search_index_only</p>
<p>确定搜索插件是否应仅生成搜索索引还是完整的搜索解决方案。当<code>search_index_only</code>设置为<code>false</code>时，搜索插件通过添加具有较低优先级的自己的<code>templates</code>目录（比主题低）并向<code>extra_javascript</code>配置设置添加其脚本来修改Jinja环境。当<code>search_index_only</code>设置为<code>true</code>或未定义时，搜索插件不会对Jinja环境进行任何修改。使用提供的索引文件的完整解决方案是主题的责任。搜索索引写入[site_dir]中的JSON文件<code>search/search_index.json</code>。文件中包含的JSON对象可以包含最多三个对象。```json
{
    config: {...},
    docs: [...],
    index: {...}
}
<pre class="highlight"><code>
如果存在，则`config`对象包含在用户的`mkdocs.yml`配置文件中为插件定义的配置选项的键/值对。`config`对象是MkDocs版本*1.0*的新功能。`docs`对象包含文档对象列表。每个文档对象由`location`（URL）、`title`和可以用于创建搜索索引和/或显示搜索结果的`text`组成。如果存在，则`index`对象包含预构建索引，可为较大站点提供性能改进。请注意，只有当用户显式启用了[prebuild_index]配置选项时，才会创建预构建的索引。主题应该预计索引不存在，但可以选择在可用时使用索引。`index`对象是MkDocs版本*1.0*的新功能。[Jinja2 template]: https://jinja.palletsprojects.com/
[built-in themes]: https://github.com/mkdocs/mkdocs/tree/master/mkdocs/themes
[主题的配置文件]: #主题配置
[lunr.js]: https://lunrjs.com/
[site_dir]: ../user-guide/configuration.md#site_dir
[prebuild_index]: ../user-guide/configuration.md#prebuild_index
[Jinja's default filters]: https://jinja.palletsprojects.com/en/latest/templates/#builtin-filters

## 打包主题

MkDocs使用[Python packaging]来分发主题，其中有一些要求。有关包含一个主题的包的示例，请参见[MkDocs Bootstrap主题]，有关包含许多主题的包的示例，请参见[MkDocs Bootswatch主题]。

注意:不必严格打包主题，因为整个主题可以包含在`custom_dir`中。如果您创建了“一次性主题”。但是，如果您打算分发您的主题供他人使用，则打包主题具有某些优点。通过打包您的主题，您的用户可以更轻松地安装它，他们可以依赖于定义的默认[configuration]，然后他们可以利用[custom_dir]来调整您的主题以更好地符合其需求。[Python packaging]: https://packaging.python.org/en/latest/
[MkDocs Bootstrap theme]: https://mkdocs.github.io/mkdocs-bootstrap/
[MkDocs Bootswatch theme]: https://mkdocs.github.io/mkdocs-bootswatch/

### 包装布局

以下布局建议用于主题。该目录处于顶层目录中，称为`MANIFEST.in`和`setup.py`旁边的主题目录，其包含一个空的`__init__.py`文件，一个主题配置文件（`mkdocs_theme.yml`）以及您的模板和媒体文件。

```text
.|-- MANIFEST.in
|-- theme_name
|   |-- __init__.py
|   |-- mkdocs_theme.yml
|   |-- main.html
|   |-- styles.css
`-- setup.py</code></pre></p>
<p>在<code>MANIFEST.in</code>文件中，应包含以下内容，但应将<code>theme_name</code>更新为包括任何额外文件扩展名的内容。</p>
<pre class="highlight"><code class="language-text">recursive-include theme_name *.ico *.js *.css *.png *.html *.eot *.svg *.ttf *.woff
recursive-exclude * __pycache__
recursive-exclude * *.py[co]</code></pre>
<p><code>setup.py</code>应包括以下文本，其中包含下面讲述的修改。</p>
<pre class="highlight"><code class="language-python">from setuptools import setup, find_packages

VERSION = '0.0.1'

setup(
    name="mkdocs-themename",
    version=VERSION,
    url='',
    license='',
    description='',
    author='',
    author_email='',
    packages=find_packages(),
    include_package_data=True,
    entry_points={
        'mkdocs.themes': [
            'themename = theme_name',
        ]
    },
    zip_safe=False
)</code></pre>
<p>填写URL、许可证、描述、作者和作者电子邮件地址。名称应遵循<code>mkdocs-themename</code>约定（如<code>mkdocs-bootstrap</code>和<code>mkdocs-bootswatch</code>），以MkDocs开头，使用连字符分隔单词，包括您的主题名称。文件的大部分内容可以不编辑。我们还需要更改最后一个部分entry_points。这是MkDocs找到您包含在包中的主题的方式。左侧的名称是用户将在其mkdocs.yml中使用的名称，右侧是包含主题文件的目录。您在本节开头创建的目录应该包含所有其他主题文件的主要文件main.html。至少，它必须包含主题的<code>main.html</code>。<strong>必须</strong>还包括一个名为<code>__init__.py</code>的文件，该文件应为空文件，该文件告诉Python该目录是软件包。### 主题配置</p>
<p>打包主题需要包含一个名为<code>mkdocs_theme.yml</code>的配置文件，该文件位于模板文件的根目录中。文件应该包含主题的默认配置选项。但是，如果该主题未提供配置选项，则仍需要该文件，并且可以留空。不需要一个名为<code>mkdocs_theme.yml</code>的未打包的主题文件，因为该文件不会从<code>theme.custom_dir</code>中加载。主题作者可以定义任何认为必要的任意选项，并且这些选项将在模板中可用于控制行为。例如，主题可能希望使侧边栏是可选的，并在<code>mkdocs_theme.yml</code>文件中包括以下内容：</p>
<pre class="highlight"><code class="language-yaml">show_sidebar: true</code></pre>
<p>然后，在模板中，可以引用该配置选项：</p>
<pre class="highlight"><code class="language-django">{% if config.theme.show_sidebar %}
&lt;div id="sidebar"&gt;...&lt;/div&gt;
{% endif %}</code></pre>
<p>用户可以在其项目的<code>mkdocs.yml</code>配置文件中覆盖此默认值：</p>
<pre class="highlight"><code class="language-yaml">theme:
  name: themename
  show_sidebar: false</code></pre>
<p>除了主题定义的任意选项外，MkDocs定义了一些特殊选项，它们会改变其行为：</p>
<div class="admonition block">
<p class="admonition-title">Block</p>
<h4 id="locale">
locale<a class="headerlink" href="#locale" title="Permanent link"></a></h4>
<p>此选项镜像了主题配置选项中的[开关]。如果<code>mkdocs_theme.yml</code>文件中未定义此值，并且用户在<code>mkdocs.yml</code>中未设置它，则它将默认为<code>en</code>（英语）。该值应与主题中使用的文本匹配（例如，“上一个”和“下一个”链接），并应作为<code>&lt;html&gt;</code>标记的<code>lang</code>属性的值使用。有关详细信息，请参见<a href="#支持主题本地化/翻译">支持主题本地化/翻译</a>。
请注意，在配置验证期间，提供的字符串会转换为<code>Locale</code>对象。该对象包含<code>Locale.language</code>和<code>Locale.territory</code>属性，并且将在模板中作为字符串解析。因此，以下内容将正常工作：</p>
<pre class="highlight"><code class="language-html">&lt;html lang="{ config.theme.locale }"&gt;</code></pre>
<p>如果语言设置为<code>fr_CA</code>（加拿大法语），则上面的模板将呈现为：</p>
<pre class="highlight"><code class="language-html">&lt;html lang="fr_CA"&gt;</code></pre>
<p>如果您不想包括领域属性，则直接引用<code>language</code>属性：</p>
<pre class="highlight"><code class="language-html">&lt;html lang="{ config.theme.locale.language }"&gt;</code></pre>
<p>那将呈现为：</p>
<pre class="highlight"><code class="language-html">&lt;html lang="fr"&gt;</code></pre>
<h4 id="static_templates">static_templates<a class="headerlink" href="#static_templates" title="Permanent link"></a></h4>
<p>此选项镜像了主题配置中的[开关]，并允许设置一些默认值。请注意，虽然用户可以向此列表添加模板，但用户不能删除包含在主题配置中的模板。</p>
<h4 id="extends">extends<a class="headerlink" href="#extends" title="Permanent link"></a></h4>
<p>定义此主题所继承的父主题。该值应为父主题的固定字符串名称。适用正常[Jinja继承规则]。插件还可以定义一些选项，允许主题通知插件它希望使用哪些插件选项。请参见任何您希望在主题中支持的插件的文档。### 分发主题</p>
</div>
<p>按照上述更改，您的主题现在应该准备安装了。这可以使用pip完成，如果仍在setup.py所在目录中，则可以使用<code>pip install .</code>。大多数Python软件包，包括MkDocs，在PyPI上分发。为此，您应该运行以下命令。</p>
<pre class="highlight"><code class="language-bash">python setup.py register</code></pre>
<p>如果您还没有设置帐户，则会提示您创建一个。有关详细信息，请参见官方Python打包文档[Packaging and Distributing Projects]。[Packaging and Distributing Projects]: https://packaging.python.org/en/latest/distributing/</p>
<h2 id="_12">支持主题本地化/翻译<a class="headerlink" href="#_12" title="Permanent link"></a></h2>
<p>虽然内置主题提供了在模板中<a href="../../user-guide/localizing-your-theme/">本地化/翻译</a>的支持，但自定义主题和第三方主题可能选择不支持。无论如何，<code>theme</code>配置选项中的<a href="#locale"><code>locale</code></a>设置始终存在，其他部分依赖于它。因此，建议所有第三方主题使用相同的设置来指定语言，而不考虑它们用于翻译的系统。以这种方式，无论用户选择哪个主题，都将体验到一致的行为。</p>
<p>翻译管理方法由主题的开发人员决定。然而，如果主题开发人员选择使用内置主题使用的机制，则以下各节概述如何启用和使用MkDocs使用的相同命令。</p>
<h3 id="_13">使用本地化/翻译命令<a class="headerlink" href="#_13" title="Permanent link"></a></h3>
<p>警告:
由于默认情况下<a href="https://babel.pocoo.org/en/latest/setup.html">pybabel</a>未安装，并且大多数用户不会安装pybabel，请确保已安装必要的依赖项（使用<code>pip install mkdocs[i18n]</code>）。否则，主题开发人员和/或翻译人员应确保已安装必要的依赖项。</p>
<p>翻译命令应从主题的工作树的根目录中调用。有关MkDocs用于翻译内置主题的工作流程的概述，请参见Contributing Guide的相应<a href="../../about/contributing/#submitting-changes-to-the-builtin-themes">部分</a>和<a href="../translations/">Translation Guide</a>。</p>
<h3 id="_14">示例自定义主题的本地化/翻译工作流程<a class="headerlink" href="#_14" title="Permanent link"></a></h3>
<p>请按照<a href="https://github.com/mkdocs/mkdocs-basic-theme">MkDocs基本主题</a>的示例，随时添加任何翻译。通过在HTML源中使用<code>{% trans %}</code>和<code>{% endtrans %}</code>包装文本来编辑模板，如下所示：</p>
<pre class="highlight"><code class="language-diff">--- a/basic_theme/base.html
+++ b/basic_theme/base.html
@@ -88,7 +88,7 @@

 &lt;body&gt;

-  &lt;h1&gt;This is an example theme for MkDocs.&lt;/h1&gt;
+  &lt;h1&gt;{% trans %}This is an example theme for MkDocs.{% endtrans %}&lt;/h1&gt;

   &lt;p&gt;
     It is designed to be read by looking at the theme HTML which is heavily</code></pre>
<p>然后，按照[翻译指南]的常规方式启动翻译工作。### 与主题一起打包翻译</p>
<p>当<code>extract_messages</code>命令创建的可移植对象模板（<code>pot</code>）文件和<code>init_catalog</code>和<code>update_catalog</code>命令创建的可移植对象(<code>po</code>)文件用于创建和编辑翻译时，它们不直接用于MkDocs并且不需要包含在主题的打包版本中。当MkDocs使用翻译构建站点时，它只使用指定语言的二进制<code>mo</code>文件。因此，在[打包主题]时，请确保在“wheels”中包含它，使用<code>MANIFEST.in</code>文件或其他方式。然后，在构建Python软件包之前，您将希望确保针对每种语言的二进制<code>mo</code>文件是最新的，通过为每种语言运行<code>compile_catalog</code>命令来完成。</p>
<p>MkDocs希望二进制<code>mo</code>文件位于<code>locales/&lt;locale&gt;/LC_MESSAGES/messages.mo</code>，该文件由<code>compile_catalog</code>命令自动执行。有关详细信息，请参见[Testing theme translations]。请注意:
如我们的<a href="../translations/">Translation Guide</a>中所述，MkDocs项目已选择包含<a href="https://babel.pocoo.org/en/latest/setup.html">pybabel</a>为我们的代码存储库中的<code>pot</code>和<code>po</code>文件，但未包含<code>mo</code>文件。这需要我们始终</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2014 <a href="https://twitter.com/starletdreaming">Tom Christie</a>, Maintained by the <a href="/about/release-notes/#maintenance-team">MkDocs Team</a>.</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/jquery-3.6.0.min.js"></script>
        <script src="../../js/bootstrap.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
